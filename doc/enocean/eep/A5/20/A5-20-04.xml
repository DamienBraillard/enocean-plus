<eep>
  <profile>
    <rorg>
      <number>0xA5</number>
      <title>4BS Telegram</title>
      <telegram>4BS</telegram>
      <func>
        <number>0x20</number>
        <title>HVAC Components</title>
        <type>
          <number>0x04</number>
          <title>Heating Radiator Valve Actuating Drive with Feed and Room Temperature Measurement, Local Set Point Control and Display</title>
          <status>released</status>
          <description><span style="background-color:#CDFF7D;border-bottom:2px groove #000000;font-style:italic;">Submitter: Holter Regelarmaturen GmbH &amp; Co. KG</span><br/><br/><span style="border-bottom:2px groove #000000;">Description</span><br/>The following document describes the communication between a controller
            and an intelligent heating radiator valve actuating drive with the following features:
            <ul><li>Feed temperature measurement</li><br/><li>Room temperature measurement</li><br/><li>Current position feedback</li><br/><li>Display</li><br/><li>Button</li><br/><li>On device temperature set point selection</li><br/></ul>
            In order to be able to process this information and control the actuator,
            every command has been included in this document. Each customer can use
            his own controller by implementing the EEP of this document.
            <br/>
            <br/>
            <span style="border-bottom:2px groove #000000;">Data exchange</span>
            <br/>Direction: bidirectional
            <br/>Addressing: unicast (ADT)
            <br/>Communication trigger: event- &amp; time-triggered
            <br/>Communication interval: can be configured by the controller
            <br/>Trigger event: a trigger event occurs when the button is pressed
            or the local set point is used
            <br/>Tx delay: 550 ms is the maximum response time for Smart-Ack Devices
            and 1100 ms for devices which use the 4BS teach-in method
            <br/>Rx timeout: just 1 message per wake-up cycle
            <br/>
            <br/>
            <span style="border-bottom:2px groove #000000;">Teach-in</span>
            <br/>Teach-in method: Smart-Ack teach-in and 4BS teach-in Variation 3
            <br/>
            <br/>
            <span style="border-bottom:2px groove #000000;">Security</span>
            <br/>Encryption supported: no
            <br/>Security level format: -
            <br/>
            <br/>
            <span style="border-bottom:2px groove #000000;">Telegram Description of Direction 1</span>
            (Transmit mode / Message from the actuator to the controller)
            <br/>
            <br/>
            This direction initializes the communication, shares the needed
            data and waits for an answer from the controller.
            This allows the device to work in deep sleep mode the rest of the time.
            <br/>
            <br/>Each message from the actuator contains the following information:
            <ul><li>Current Position (CP)<br/>The current position is a feedback value from the actuator.
            It indicates the actual per cent position of the valve.
            The value 0 % means that the valve is completely closed and 100 %
            completely open. The controller can use this information for the room
            temperature regulation.</li></ul>
            <ul><li>Temperature Set Point OR Feed Temperature (FTS)*<br/>
            * This byte is shared by the Temperature Set Point and the Feed
            Temperature value. Only one of these values is sent in the same message.
            Which value is transmitted is indicated by DB0.1 (TS bit).
            <br/>
            The feed temperature is the water temperature in the radiator input,
            which can be useful for implementing several features in the home
            automation system.
            <br/>
            The temperature set point is only sent when the user specifies a new
            room temperature by using the local temperature set point on the device.
            </li></ul>
            <ul><li>Room Temperature (TMP) OR Failure Code (FC)*<br/>
            * This byte is shared by the Room Temperature and Failure Code Value.
            Only one of these values is sent in the same message.
            The value transmitted is indicated by DB0.0 (FL).
            By default it is the room temperature.
            <br/>
            The room temperature is the ambient temperature of the place in which
            the device is used and is measured by the actuator.
            This value is transmitted if no error occurred.
            <br/>
            The Failure Code is transmitted instead of the Room Temperature
            if an error occurs.
            </li></ul>
            <ul><li>Measurement Status (MST)<br/>
            The temperature measurements (room and feed temperature) can be
            deactivated in order to reduce the energy consumption.
            This can be specified only by the controller i.e. to implement
            summer mode or to replace the internal room temperature measurement
            of the actuator by an external one.
            </li></ul>
            <ul><li>Status Request (SRT)<br/>
            The status request bit can be used to ask the controller about its
            status. If the controller does not send back the correct reply, the
            actuator will start its own room temperature regulation.
            With this feature, a frozen actuator would not interrupt the room
            temperature regulation.
            </li></ul>
            <ul><li>Teach-in Bit (LRNB)<br/>
            For establishing the radio link between the controller and the actuator,
            a teachin message has to be sent from the actuator to the controller.
            If the binary value 0 is transmitted, the message will be identified
            as a teach-in one and will allow the controller to receive the
            EnOcean-ID of the actuator.
            </li></ul>
            <ul><li>Button Lock Status (BLS)<br/>
            The button lock status can be set by the controller. This enables or
            disables the manual room temperature selection. If locked, the manual
            room temperature selection on the actuator will be disabled and the
            user will be notified with a symbol on the display.
            </li></ul>
            <ul><li>Temperature Selection (TS)<br/>
            If the user specifies a temperature set point manually on the device,
            this will be sent to the controller and indicated on the temperature
            selection field (TS). It can indicate that the field FTS contains the
            temperature set point (binary value = 1) or the feed temperature
            (binary value = 0).
            </li></ul>
            <ul><li>Failure (FL)<br/>
            Indicates the occurrence of a failure. The room temperature value is
            replaced by the failure code if the bit FL has the binary value 1.
            </li></ul>
            <br/>
            <span style="border-bottom:2px groove #000000;">Telegram Description of Direction 2</span>
            (Receive mode / Commands from the controller to the actuator)
            <br/>
            <br/>
            The messages from the controller to the actuator are sent in this direction.
            A message in this direction has to be sent after receiving a message from
            the actuator, in order to achieve a successful communication.
            If the controller message is not received by the actuator in a specific
            time after a direction 1 message, no information will be received by
            the actuator. The time that the actuator will wait for a reply is defined
            by the Smart-Ack Teach-In process. For controllers which cannot use
            Smart-Ack, the 4BS Teach-in Variation 3 has to be used, with a maximum
            response time of 1100 ms.
            <br/>
            <br/>Each message from the controller contains the following information:
            <ul><li>Valve Position (POS)<br/>
            The valve position is a set point position for the valve.
            It indicates the per cent position of the valve, which the actuator
            has to reach. The value 0 % means that the valve is completely closed
            and 100 % completely open. The controller should be able to regulate
            the room temperature by adjusting this value.
            </li></ul>
            <ul><li>Temperature Set Point (TSP)<br/>
            The controller can send the temperature set point to the actuator in
            order to allow the user to see the actual specified temperature in
            the device display. This value does not affect room temperature regulation.
            </li></ul>
            <ul><li>Measurement Control (MC)<br/>
            The temperature measurements (room and feed temperature) can be
            deactivated in order to reduce energy consumption. This can be specified
            only by the controller i.e. to implement summer mode or to replace
            the internal room temperature measurement by the device with an
            external one. The measurement control bit enables the controller to
            activate or deactivate the measurements.
            </li></ul>
            <ul><li>Wake-up Cycle (WUC)<br/>
            To save energy, the actuator works in deep sleep mode the most of the
            time. Nevertheless it has to wake up to communicate with the controller
            and to reach the valve position specified by the controller.
            The longer the actuator remains in deep sleep mode, the more energy
            efficient will be your batteries. If fast response is required, the
            actuator has to communicate more frequently with the controller and
            that is why it should use a shorter wake-up cycle. If a fast room
            temperature control is not required, the wake-up cycle should be set
            by the controller as long as possible.
            </li></ul>
            <ul><li>Display Orientation (DSO)<br/>
            The heater valves can be installed in different directions.
            That is why it can be useful to have the option to choose the fitting
            display orientation. This feature makes reading the display easier.
            </li></ul>
            <ul><li>Teach-in Bit (LRNB)<br/>
            For establishing a radio link between the controller and the actuator,
            a teach-in telegram has to be sent from the controller to the actuator.
            If the binary value 0 is transmitted, the message will be identified
            as a teach-in one and will allow the device to receive the EnOcean-ID
            from the controller.
            </li></ul>
            <ul><li>Button Lock Control (BLS)<br/>
            The button lock status can be set by the controller. This enables or
            disables the manual room temperature selection. If locked, the manual
            room temperature selection on the actuator will be disabled and the
            user will be notified with a symbol on the display.
            </li></ul>
            <ul><li>Service Command (SER)<br/>
            In order to adapt the actuator to a new valve, the controller can
            order the execution of some functions of the actuator:
            <br/>
            - run initialisation: This function has to be executed for adapting
            the actuator to the length of the valve stroke.
            <br/>
            - open valve: To facilitate the installation or maintenance of the
            valve, the actuator can open the valve completely.
            After completely opening the valve it is necessary to run the initialisation.
            <br/>
            - close valve: Completely close the valve.
            </li></ul>
            </description>
          <case>
            <direction>1</direction>
            <condition>
              <direction>1</direction>
            </condition>
            <datafield>
              <reserved/>
              <bitoffs>26</bitoffs>
              <bitsize>2</bitsize>
            </datafield>
            <datafield>
              <data>LRN Bit</data>
              <shortcut>LRNB</shortcut>
              <description>LRN Bit</description>
              <bitoffs>28</bitoffs>
              <bitsize>1</bitsize>
              <enum>
                <item>
                  <value>0</value>
                  <description>Teach-in telegram</description>
                </item>
                <item>
                  <value>1</value>
                  <description>Data telegram</description>
                </item>
              </enum>
            </datafield>
            <datafield>
              <data>Current Position</data>
              <shortcut>CP</shortcut>
              <description>Current valve position</description>
              <info></info>
              <bitoffs>0</bitoffs>
              <bitsize>8</bitsize>
              <range>
                <min>0</min>
                <max>100</max>
              </range>
              <scale>
                <min>0</min>
                <max>100</max>
              </scale>
              <unit>%</unit>
            </datafield>
            <datafield>
              <data>Feed Temperature OR Temperature Set Point</data>
              <shortcut>FTS</shortcut>
              <description>Either current feed temperature value or temperature
              set point (defined by DB0.1)</description>
              <info></info>
              <bitoffs>8</bitoffs>
              <bitsize>8</bitsize>
              <range>
                <min>0</min>
                <max>255</max>
              </range>
              <scale>
                <min>20 .. 80</min>
                <max>10 .. 30</max>
              </scale>
              <unit>&#176;C</unit>
            </datafield>
            <datafield>
              <data>Room Temperature OR Failure Code</data>
              <shortcut>TMPFC</shortcut>
              <description>Current room temperature value (10...30&#176;C) OR Failure Code (Enum)</description>
              <info/>
              <bitoffs>16</bitoffs>
              <bitsize>8</bitsize>
              <enum>
                <item>
                  <min>0</min>
                  <max>255</max>
                  <scale>
                    <min>10</min>
                    <max>30</max>
                  </scale>
                  <unit>&#176;C</unit>
                </item>
                <item>
                  <value>00 ... 16</value>
                  <description>Reserved</description>
                </item>
                <item>
                  <value>17</value>
                  <description>Measurement error</description>
                </item>
                <item>
                  <value>18</value>
                  <description>Battery empty</description>
                </item>
                <item>
                  <value>19</value>
                  <description>Reserved</description>
                </item>
                <item>
                  <value>20</value>
                  <description>Frost protection</description>
                </item>
                <item>
                  <value>21 ... 32</value>
                  <description>Reserved</description>
                </item>
                <item>
                  <value>33</value>
                  <description>Blocked valve</description>
                </item>
                <item>
                  <value>34 ... 35</value>
                  <description>Reserved</description>
                </item>
                <item>
                  <value>36</value>
                  <description>End point detection error</description>
                </item>
                <item>
                  <value>37 ... 39</value>
                  <description>Reserved</description>
                </item>
                <item>
                  <value>40</value>
                  <description>No valve</description>
                </item>
                <item>
                  <value>41 ... 48</value>
                  <description>Reserved</description>
                </item>
                <item>
                  <value>49</value>
                  <description>Not taught in</description>
                </item>
                <item>
                  <value>50 ... 52</value>
                  <description>Reserved</description>
                </item>
                <item>
                  <value>53</value>
                  <description>No response from controller</description>
                </item>
                <item>
                  <value>54</value>
                  <description>Teach-in error</description>
                </item>
                <item>
                  <value>55 ... 255</value>
                  <description>Reserved</description>
                </item>
              </enum>
            </datafield>
            <datafield>
              <data>Measurement Status</data>
              <shortcut>MST</shortcut>
              <description>Shows if the temperature measurement (feed temperature
              and room temperature) is active</description>
              <bitoffs>24</bitoffs>
              <bitsize>1</bitsize>
              <enum>
                <item>
                  <value>0</value>
                  <description>Active</description>
                </item>
                <item>
                  <value>1</value>
                  <description>Inactive</description>
                </item>
              </enum>
            </datafield>
            <datafield>
              <data>Status Request</data>
              <shortcut>STR</shortcut>
              <description>Request for status from the controller</description>
              <bitoffs>25</bitoffs>
              <bitsize>1</bitsize>
              <enum>
                <item>
                  <value>0</value>
                  <description>No change</description>
                </item>
                <item>
                  <value>1</value>
                  <description>Status requested</description>
                </item>
              </enum>
            </datafield>
            <datafield>
              <data>Button Lock Status</data>
              <shortcut>BLS</shortcut>
              <description>Shows if all buttons on the actuator are locked</description>
              <bitoffs>29</bitoffs>
              <bitsize>1</bitsize>
              <enum>
                <item>
                  <value>0</value>
                  <description>Unlocked</description>
                </item>
                <item>
                  <value>1</value>
                  <description>Locked</description>
                </item>
              </enum>
            </datafield>
            <datafield>
              <data>Temperature Selection</data>
              <shortcut>TS</shortcut>
              <description>Defines which temperature value is transmitted in DB2</description>
              <bitoffs>30</bitoffs>
              <bitsize>1</bitsize>
              <enum>
                <item>
                  <value>0</value>
                  <description>Feed temperature</description>
                </item>
                <item>
                  <value>1</value>
                  <description>Temperature set point</description>
                </item>
              </enum>
            </datafield>
            <datafield>
              <data>Failure</data>
              <shortcut>FL</shortcut>
              <description>A failure occurred, see DB1.7-DB1.0 for Failure Code</description>
              <bitoffs>31</bitoffs>
              <bitsize>1</bitsize>
              <enum>
                <item>
                  <value>0</value>
                  <description>No failure (TMP is transmitted)</description>
                </item>
                <item>
                  <value>1</value>
                  <description>failure (FC is transmitted)</description>
                </item>
              </enum>
            </datafield>
          </case>
          <case>
            <direction>2</direction>
            <condition>
              <direction>2</direction>
            </condition>
            <datafield>
              <reserved/>
              <bitoffs>16</bitoffs>
              <bitsize>1</bitsize>
            </datafield>
            <datafield>
              <reserved/>
              <bitoffs>24</bitoffs>
              <bitsize>2</bitsize>
            </datafield>
            <datafield>
              <data>Valve Position</data>
              <shortcut>POS</shortcut>
              <description>Valve position</description>
              <info/>
              <bitoffs>0</bitoffs>
              <bitsize>8</bitsize>
              <range>
                <min>0</min>
                <max>100</max>
              </range>
              <scale>
                <min>0</min>
                <max>100</max>
              </scale>
              <unit>%</unit>
            </datafield>
            <datafield>
              <data>Temperature Set Point</data>
              <shortcut>TSP</shortcut>
              <description>Temperature set point</description>
              <info/>
              <bitoffs>8</bitoffs>
              <bitsize>8</bitsize>
              <range>
                <min>0</min>
                <max>255</max>
              </range>
              <scale>
                <min>10</min>
                <max>30</max>
              </scale>
              <unit>&#176;C</unit>
            </datafield>
            <datafield>
              <data>LRN Bit</data>
              <shortcut>LRNB</shortcut>
              <description>LRN Bit</description>
              <bitoffs>28</bitoffs>
              <bitsize>1</bitsize>
              <enum>
                <item>
                  <value>0</value>
                  <description>Teach-in telegram</description>
                </item>
                <item>
                  <value>1</value>
                  <description>Data telegram</description>
                </item>
              </enum>
            </datafield>
            <datafield>
              <data>Measurement Control</data>
              <shortcut>MC</shortcut>
              <description>Control the temperature measurement (feed temperature
              + room temperature)</description>
              <bitoffs>17</bitoffs>
              <bitsize>1</bitsize>
              <enum>
                <item>
                  <value>0</value>
                  <description>Enable</description>
                </item>
                <item>
                  <value>1</value>
                  <description>Disable</description>
                </item>
              </enum>
            </datafield>
            <datafield>
              <data>Wake-up Cycle</data>
              <shortcut>WUC</shortcut>
              <description>Defines the cyclic wake-up time</description>
              <bitoffs>18</bitoffs>
              <bitsize>6</bitsize>
              <enum>
                <item>
                  <value>0</value>
                  <description>10 sec</description>
                </item>
                <item>
                  <value>1</value>
                  <description>60 sec</description>
                </item>
                <item>
                  <value>2</value>
                  <description>90 sec</description>
                </item>
                <item>
                  <value>3</value>
                  <description>120 sec</description>
                </item>
                <item>
                  <value>4</value>
                  <description>150 sec</description>
                </item>
                <item>
                  <value>5</value>
                  <description>180 sec</description>
                </item>
                <item>
                  <value>6</value>
                  <description>210 sec</description>
                </item>
                <item>
                  <value>7</value>
                  <description>240 sec</description>
                </item>
                <item>
                  <value>8</value>
                  <description>270 sec</description>
                </item>
                <item>
                  <value>9</value>
                  <description>300 sec (5 min)</description>
                </item>
                <item>
                  <value>10</value>
                  <description>330 sec</description>
                </item>
                <item>
                  <value>11</value>
                  <description>360 sec</description>
                </item>
                <item>
                  <value>12</value>
                  <description>390 sec</description>
                </item>
                <item>
                  <value>13</value>
                  <description>420 sec</description>
                </item>
                <item>
                  <value>14</value>
                  <description>450 sec</description>
                </item>
                <item>
                  <value>15</value>
                  <description>480 sec</description>
                </item>
                <item>
                  <value>16</value>
                  <description>510 sec</description>
                </item>
                <item>
                  <value>17</value>
                  <description>540 sec</description>
                </item>
                <item>
                  <value>18</value>
                  <description>570 sec</description>
                </item>
                <item>
                  <value>19</value>
                  <description>600 sec (10 min)</description>
                </item>
                <item>
                  <value>20</value>
                  <description>630 sec</description>
                </item>
                <item>
                  <value>21</value>
                  <description>660 sec</description>
                </item>
                <item>
                  <value>22</value>
                  <description>690 sec</description>
                </item>
                <item>
                  <value>23</value>
                  <description>720 sec</description>
                </item>
                <item>
                  <value>24</value>
                  <description>750 sec</description>
                </item>
                <item>
                  <value>25</value>
                  <description>780 sec</description>
                </item>
                <item>
                  <value>26</value>
                  <description>810 sec</description>
                </item>
                <item>
                  <value>27</value>
                  <description>840 sec</description>
                </item>
                <item>
                  <value>28</value>
                  <description>870 sec</description>
                </item>
                <item>
                  <value>29</value>
                  <description>900 sec (15 min)</description>
                </item>
                <item>
                  <value>30</value>
                  <description>930 sec</description>
                </item>
                <item>
                  <value>31</value>
                  <description>960 sec</description>
                </item>
                <item>
                  <value>32</value>
                  <description>990 sec</description>
                </item>
                <item>
                  <value>33</value>
                  <description>1020 sec</description>
                </item>
                <item>
                  <value>34</value>
                  <description>1050 sec</description>
                </item>
                <item>
                  <value>35</value>
                  <description>1080 sec</description>
                </item>
                <item>
                  <value>36</value>
                  <description>1110 sec</description>
                </item>
                <item>
                  <value>37</value>
                  <description>1140 sec</description>
                </item>
                <item>
                  <value>38</value>
                  <description>1170 sec</description>
                </item>
                <item>
                  <value>39</value>
                  <description>1200 sec (20 min)</description>
                </item>
                <item>
                  <value>40</value>
                  <description>1230 sec</description>
                </item>
                <item>
                  <value>41</value>
                  <description>1260 sec</description>
                </item>
                <item>
                  <value>42</value>
                  <description>1290 sec</description>
                </item>
                <item>
                  <value>43</value>
                  <description>1320 sec</description>
                </item>
                <item>
                  <value>44</value>
                  <description>1350 sec</description>
                </item>
                <item>
                  <value>45</value>
                  <description>1380 sec</description>
                </item>
                <item>
                  <value>46</value>
                  <description>1410 sec</description>
                </item>
                <item>
                  <value>47</value>
                  <description>1440 sec</description>
                </item>
                <item>
                  <value>48</value>
                  <description>1470 sec</description>
                </item>
                <item>
                  <value>49</value>
                  <description>1500 sec (25 min)</description>
                </item>
                <item>
                  <value>50</value>
                  <description>3 hrs</description>
                </item>
                <item>
                  <value>51</value>
                  <description>6 hrs</description>
                </item>
                <item>
                  <value>52</value>
                  <description>9 hrs</description>
                </item>
                <item>
                  <value>53</value>
                  <description>12 hrs</description>
                </item>
                <item>
                  <value>54</value>
                  <description>15 hrs</description>
                </item>
                <item>
                  <value>55</value>
                  <description>18 hrs</description>
                </item>
                <item>
                  <value>56</value>
                  <description>21 hrs</description>
                </item>
                <item>
                  <value>57</value>
                  <description>24 hrs</description>
                </item>
                <item>
                  <value>58</value>
                  <description>27 hrs</description>
                </item>
                <item>
                  <value>59</value>
                  <description>30 hrs</description>
                </item>
                <item>
                  <value>60</value>
                  <description>33 hrs</description>
                </item>
                <item>
                  <value>61</value>
                  <description>36 hrs</description>
                </item>
                <item>
                  <value>62</value>
                  <description>39 hrs</description>
                </item>
                <item>
                  <value>63</value>
                  <description>42 hrs (max)</description>
                </item>
              </enum>
            </datafield>
            <datafield>
              <data>Display Orientation</data>
              <shortcut>DSO</shortcut>
              <description>Adjusts the display orientation</description>
              <bitoffs>26</bitoffs>
              <bitsize>2</bitsize>
              <enum>
                <item>
                  <value>0</value>
                  <description>0&#176;</description>
                </item>
                <item>
                  <value>1</value>
                  <description>90&#176;</description>
                </item>
                <item>
                  <value>2</value>
                  <description>180&#176;</description>
                </item>
                <item>
                  <value>3</value>
                  <description>270&#176;</description>
                </item>
              </enum>
            </datafield>
            <datafield>
              <data>Button Lock Control</data>
              <shortcut>BLC</shortcut>
              <description>Set the button lock status</description>
              <bitoffs>29</bitoffs>
              <bitsize>1</bitsize>
              <enum>
                <item>
                  <value>0</value>
                  <description>Unlocked</description>
                </item>
                <item>
                  <value>1</value>
                  <description>Locked</description>
                </item>
              </enum>
            </datafield>
            <datafield>
              <data>Service Command</data>
              <shortcut>SER</shortcut>
              <description>Initiates certain temporary service operations</description>
              <bitoffs>30</bitoffs>
              <bitsize>2</bitsize>
              <enum>
                <item>
                  <value>0</value>
                  <description>No change</description>
                </item>
                <item>
                  <value>1</value>
                  <description>Open valve</description>
                </item>
                <item>
                  <value>2</value>
                  <description>Run initialisation</description>
                </item>
                <item>
                  <value>3</value>
                  <description>Close valve</description>
                </item>
              </enum>
            </datafield>
          </case>
        </type>
      </func>
    </rorg>
  </profile>
</eep>
